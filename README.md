## RepeatDefeaters - Utilities for unclassified consensus sequences

## Table of Contents
- [**Introduction**](#introduction)
    - [Motivation](#motivation)
    - [Key features](#key-features)
    - [TE activity](#te-activity)

- [**Usage**](#usage)
    - [Dependancies](#dependancies)
    - [Customisation for Uppmax](#customisation-for-uppmax)
## Introduction

### Motivation

For recently sequenced non-model organisms, repeat discovery tools
often fail to classify a large portion of their repeats. These
unclassified repeats can be host genes that were duplicated, or TEs
that are just not present in the databases. Analyses of Transposable
Elements (TE) can be misleading if host genes are present.
RepeatDefeaters is a tool to further classify which repeats should
be considered host genes or TEs.

A critical task during repeat discovery is to accurately annotate
TEs. This can be challenging for new organisms that have few
references to compare with. RepeatDefeaters aims to provide an
easy-to-follow guideline on how to tackle these consensus sequences
that are difficult to classify automatically.

### Key features

RepeatDefeaters provides:

1. Utilities that work together to determine if your consensus
sequence of interest is related to TE activity.

### TE activity

A list of keywords which suggest TE activity has been included
in the file `assets/pfam_te_domain_keywords.txt`. These have
been derived by [ FIXME: How were these keywords derived? ].
From these keywords, a list of Pfam sequence Ids that might
relate to TE activities has been
generated by running the `PFAM_TRANSPOSIBLE_ELEMENT_SEARCH` process.
The list can be found under `assets/Pfam_R32.Proteins_wTE_Domains.seqid`.

By setting the workflow parameter `pfam_proteins_with_te_domain_list`
in the `params` configuration block, the
`PFAM_TRANSPOSIBLE_ELEMENT_SEARCH` can be skipped to save computation time.
```nextflow
pfam_proteins_with_te_domain_list = "$baseDir/assets/Pfam_R32.Proteins_wTE_Domains.seqid"
```

## Usage

Usage:
```bash
nextflow run -c <parameter.config> [-profile <executor profile>] GroundB/RepeatDefeaters
```

where:
- `<parameter.config>` is a nextflow configuration file which provides
    paths to the input data (see the [params.config template](params.config.TEMPLATE)).
    Alternatively parameters can be provided on the
    command-line using the `--parameter` notation (e.g., `--species_short_name <str>` ).
- `<executor profile>` is one of the preconfigured execution profiles
    (`uppmax`, `singularity_local`, `docker_local`). Alternatively,
    you can provide a custom configuration to configure this workflow
    to your execution environment. See [Nextflow Configuration](https://www.nextflow.io/docs/latest/config.html#scope-executor)
    for more details.

### Dependancies

- [Nextflow](Nextflow.io/): A workflow manager. It can be installed
    into a custom conda environment (recommended), or directly
    into your bin. A conda environment file (nextflow_conda-env.yml) is
    provided to create a running environment with the necessary
    dependancies.
- Package Manager: One of the following (Docker or Singularity is preferred).
    - [Docker](https://www.docker.com/): A container platform.
    - [Singularity](https://sylabs.io/singularity/): A container platform,
    more commonly used on multi-user HPC environments.
    - [Conda](https://docs.conda.io/en/latest/miniconda.html): A package
    manager, which is operating system dependent.

### Customisation for Uppmax.

Uppmax is a set of High Performance Clusters (HPC) available to the Swedish
research community. A custom profile is available to ease use on
an Uppmax HPC. Nextflow will submit jobs to the slurm queue manager,
and use the node local storage `$SNIC_TMP` for intermediate computations.

```bash
nextflow run -c <parameter.config> -profile uppmax GroundB/RepeatDefeaters
```

In order to submit to slurm, a SNIC project allocation must be provided.
This can be provided using the workflow parameter `project`.
E.g., `project = snic20xx-yy-zz` in the `params` block of the
configuration file, or `--project snic20xx-xx-zz` on the command line.


### Contributing to RepeatDefeaters
I genuinely believe that a community-maintained database will serve the transposon research the best in the long-term. Active participation in annotating unclassified consensus sequences, establishing and optimizing profile-HMMs of TE proteins are very much needed. "RepeatDefeaters" should be a resource center that is reviewed and contributed by many, therefore the plural name.
For anyone wishing to help, join our [RepeatDefeaters Discord](https://discord.gg/SKatqNn).
